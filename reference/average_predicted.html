<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Average Predictions — average_predicted • effectplots</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Average Predictions — average_predicted"><meta property="og:description" content="Calculates average predictions over the values of one or multiple features specified
by X. Shows the combined effect of a feature and other (correlated) features."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">effectplots</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mayer79/effectplots/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Average Predictions</h1>
    <small class="dont-index">Source: <a href="https://github.com/mayer79/effectplots/blob/0.2.2/R/average_predicted.R" class="external-link"><code>R/average_predicted.R</code></a></small>
    <div class="hidden name"><code>average_predicted.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates average predictions over the values of one or multiple features specified
by <code>X</code>. Shows the combined effect of a feature and other (correlated) features.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">average_predicted</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">pred</span>,</span>
<span>  w <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x_name <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>  breaks <span class="op">=</span> <span class="st">"Sturges"</span>,</span>
<span>  right <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  discrete_m <span class="op">=</span> <span class="fl">13L</span>,</span>
<span>  outlier_iqr <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A vector, matrix, or data.frame with features.</p></dd>


<dt id="arg-pred">pred<a class="anchor" aria-label="anchor" href="#arg-pred"></a></dt>
<dd><p>A numeric vector of predictions.</p></dd>


<dt id="arg-w">w<a class="anchor" aria-label="anchor" href="#arg-w"></a></dt>
<dd><p>An optional numeric vector of weights. Having observations with
non-positive weight is equivalent to excluding them.</p></dd>


<dt id="arg-x-name">x_name<a class="anchor" aria-label="anchor" href="#arg-x-name"></a></dt>
<dd><p>If <code>X</code> is a vector: what is the name of the variable? By default "x".</p></dd>


<dt id="arg-breaks">breaks<a class="anchor" aria-label="anchor" href="#arg-breaks"></a></dt>
<dd><p>An integer, vector, or "Sturges" (the default) used to determine
bin breaks of continuous features. Values outside the total bin range are placed
in the outmost bins. To allow varying values of <code>breaks</code> across features,
<code>breaks</code> can be a list of the same length as <code>v</code>, or a <em>named</em> list with breaks
for certain variables.</p></dd>


<dt id="arg-right">right<a class="anchor" aria-label="anchor" href="#arg-right"></a></dt>
<dd><p>Should bins be right-closed? The default is <code>TRUE</code>.
Vectorized over <code>v</code>. Only relevant for continuous features.</p></dd>


<dt id="arg-discrete-m">discrete_m<a class="anchor" aria-label="anchor" href="#arg-discrete-m"></a></dt>
<dd><p>Numeric features with up to this number of unique values should not
be binned but rather treated as discrete. The default is 13. Vectorized over <code>v</code>.</p></dd>


<dt id="arg-outlier-iqr">outlier_iqr<a class="anchor" aria-label="anchor" href="#arg-outlier-iqr"></a></dt>
<dd><p>If <code>breaks</code> is an integer or "Sturges", the breaks of a continuous
feature are calculated without taking into account feature values outside
quartiles +- <code>outlier_iqr</code> * IQR (where &lt;= 9997 values are used to calculate the
quartiles). To let the breaks cover the full data range, set <code>outlier_iqr</code> to
0 or <code>Inf</code>. Vectorized over <code>v</code>.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Optional integer random seed used for calculating breaks:
The bin range is determined without values outside quartiles +- 2 IQR
using a sample of &lt;= 9997 observations to calculate quartiles.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Currently unused.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list (of class "EffectData") with a data.frame per feature having columns:</p><ul><li><p><code>bin_mid</code>: Bin mid points. In the plots, the bars are centered around these.</p></li>
<li><p><code>bin_width</code>: Absolute width of the bin. In the plots, these equal the bar widths.</p></li>
<li><p><code>bin_mean</code>: For continuous features, the (possibly weighted) average feature
value within bin. For discrete features equivalent to <code>bin_mid</code>.</p></li>
<li><p><code>N</code>: The number of observations within bin.</p></li>
<li><p><code>weight</code>: The weight sum within bin. When <code>w = NULL</code>, equivalent to <code>N</code>.</p></li>
<li><p>Different statistics, depending on the function call.</p></li>
</ul><p>Use single bracket subsetting to select part of the output. Note that each
data.frame contains an attribute "discrete" with the information whether the
feature is discrete or continuous. This attribute might be lost when you manually
modify the data.frames.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The function is a convenience wrapper around <code><a href="feature_effects.html">feature_effects()</a></code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Apley, Daniel W., and Jingyu Zhu. 2016. <em>Visualizing the Effects of Predictor Variables in Black Box Supervised Learning Models.</em>
Journal of the Royal Statistical Society Series B: Statistical Methodology,
82 (4): 1059–1086. doi:10.1111/rssb.12377.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="feature_effects.html">feature_effects()</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fu">average_predicted</span><span class="op">(</span><span class="va">iris</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">iris</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">M</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'EffectData' object of length 4, starting with 'Sepal.Width': </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bin_mid bin_width bin_mean  N weight pred_mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    2.25       0.5 2.368421 19     19  5.532860</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    2.75       0.5 2.867188 64     64  6.111200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    3.25       0.5 3.277083 48     48  5.706627</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    3.75       0.5 3.756250 16     16  5.631317</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    4.25       0.5 4.233333  3      3  5.413218</span>
<span class="r-in"><span><span class="va">M</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="average_predicted-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Michael Mayer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

